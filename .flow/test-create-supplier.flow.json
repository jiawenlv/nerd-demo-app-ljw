{
  "version": "1.0.0",
  "nodes": [
    {
      "id": "3b6b487613cbdbcdcdebe1e0d164b0e6",
      "name": "Start",
      "type": "start",
      "desc": "开始节点，接收供应商基本信息",
      "inputs": {
        "SupplierCode": {
          "type": "string",
          "desc": "供应商编码",
          "value": "LJW"
        },
        "SupplierName": {
          "type": "string",
          "desc": "供应商名称",
          "value": "吕嘉文"
        },
        "ContactName": {
          "type": "string",
          "desc": "联系人姓名",
          "value": "吕文"
        },
        "Phone": {
          "type": "string",
          "desc": "联系电话",
          "value": "111"
        },
        "Email": {
          "type": "string",
          "desc": "邮箱地址",
          "value": "22"
        },
        "Address": {
          "type": "string",
          "desc": "地址信息",
          "value": "111@abc.com"
        }
      },
      "nextNodes": [
        "ValidateInput"
      ]
    },
    {
      "id": "df14b2c0980b00a7a33955c0d055c011",
      "name": "HandleCreateFailure",
      "type": "code",
      "desc": "处理创建失败的逻辑",
      "inputs": {
        "GeneratedSupplierId": {
          "type": "string",
          "desc": "生成的供应商ID",
          "value": "$.GenerateSupplierId.outputs.GeneratedSupplierId"
        },
        "ValidatedSupplierName": {
          "type": "string",
          "desc": "验证后的供应商名称",
          "value": "$.ValidateInput.outputs.ValidatedSupplierName"
        }
      },
      "outputs": {
        "ErrorMessage": {
          "type": "string",
          "desc": "错误消息",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        },
        "ErrorCode": {
          "type": "string",
          "desc": "错误代码",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        }
      },
      "configs": {
        "file": {
          "name": "handleCreateFailure.js"
        },
        "dependencies": []
      },
      "nextNodes": [
        "EndFailure"
      ]
    },
    {
      "id": "51afdf177460609adb98bbbc8b444d04",
      "name": "EndFailure",
      "type": "end",
      "desc": "失败结束节点",
      "inputs": {
        "ErrorMessage": {
          "type": "string",
          "desc": "错误消息",
          "value": "$.HandleCreateFailure.outputs.ErrorMessage"
        },
        "ErrorCode": {
          "type": "string",
          "desc": "错误代码",
          "value": "$.HandleCreateFailure.outputs.ErrorCode"
        }
      },
      "outputs": {
        "code": {
          "type": "number",
          "desc": "响应状态码",
          "value": 500,
          "builtinAttrName": "code",
          "isDynamic": true,
          "isBuiltin": true,
          "editable": true,
          "removable": false
        },
        "data": {
          "type": "object",
          "desc": "响应数据",
          "value": {
            "error": "$.HandleCreateFailure.outputs.ErrorMessage",
            "errorCode": "$.HandleCreateFailure.outputs.ErrorCode"
          },
          "builtinAttrName": "data",
          "isDynamic": true,
          "isBuiltin": true,
          "editable": true,
          "removable": false
        },
        "message": {
          "type": "string",
          "desc": "响应消息",
          "value": "供应商创建失败",
          "builtinAttrName": "message",
          "isDynamic": true,
          "isBuiltin": true,
          "editable": true,
          "removable": false
        }
      }
    },
    {
      "id": "980fe08b01ecc283a775dfecd7bc09b0",
      "name": "ValidateInput",
      "type": "code",
      "desc": "验证输入参数的有效性",
      "inputs": {
        "SupplierCode": {
          "type": "string",
          "desc": "供应商编码",
          "value": "$.Start.inputs.SupplierCode"
        },
        "SupplierName": {
          "type": "string",
          "desc": "供应商名称",
          "value": "$.Start.inputs.SupplierName"
        },
        "ContactName": {
          "type": "string",
          "desc": "联系人姓名",
          "value": "$.Start.inputs.ContactName"
        },
        "Phone": {
          "type": "string",
          "desc": "联系电话",
          "value": "$.Start.inputs.Phone"
        },
        "Email": {
          "type": "string",
          "desc": "邮箱地址",
          "value": "$.Start.inputs.Email"
        },
        "Address": {
          "type": "string",
          "desc": "地址信息",
          "value": "$.Start.inputs.Address"
        }
      },
      "outputs": {
        "ValidatedSupplierCode": {
          "type": "string",
          "desc": "验证后的供应商编码",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        },
        "ValidatedSupplierName": {
          "type": "string",
          "desc": "验证后的供应商名称",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        },
        "ValidatedContactName": {
          "type": "string",
          "desc": "验证后的联系人姓名",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        },
        "ValidatedPhone": {
          "type": "string",
          "desc": "验证后的联系电话",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        },
        "ValidatedEmail": {
          "type": "string",
          "desc": "验证后的邮箱地址",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        },
        "ValidatedAddress": {
          "type": "string",
          "desc": "验证后的地址信息",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        }
      },
      "configs": {
        "file": {
          "name": "validateInput.js"
        },
        "dependencies": []
      },
      "nextNodes": [
        "GenerateSupplierId"
      ]
    },
    {
      "id": "ef0b76ebb0a4c94f5427d12225a2af74",
      "name": "GenerateSupplierId",
      "type": "code",
      "desc": "生成唯一的供应商ID",
      "inputs": {
        "ValidatedSupplierCode": {
          "type": "string",
          "desc": "验证后的供应商编码",
          "value": "$.ValidateInput.outputs.ValidatedSupplierCode"
        }
      },
      "outputs": {
        "GeneratedSupplierId": {
          "type": "string",
          "desc": "生成的唯一供应商ID",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        }
      },
      "configs": {
        "file": {
          "name": "generateSupplierId.js"
        },
        "dependencies": []
      },
      "nextNodes": [
        "CreateSupplierRecord"
      ]
    },
    {
      "id": "80df1ceb7edaa47af7c7637409312352",
      "name": "CreateSupplierRecord",
      "type": "customSQL",
      "desc": "在数据库中创建供应商记录",
      "inputs": {
        "GeneratedSupplierId": {
          "type": "string",
          "desc": "生成的供应商ID",
          "value": "$.GenerateSupplierId.outputs.GeneratedSupplierId"
        },
        "ValidatedSupplierCode": {
          "type": "string",
          "desc": "验证后的供应商编码",
          "value": "$.ValidateInput.outputs.ValidatedSupplierCode"
        },
        "ValidatedSupplierName": {
          "type": "string",
          "desc": "验证后的供应商名称",
          "value": "$.ValidateInput.outputs.ValidatedSupplierName"
        },
        "ValidatedContactName": {
          "type": "string",
          "desc": "验证后的联系人姓名",
          "value": "$.ValidateInput.outputs.ValidatedContactName"
        },
        "ValidatedPhone": {
          "type": "string",
          "desc": "验证后的联系电话",
          "value": "$.ValidateInput.outputs.ValidatedPhone"
        },
        "ValidatedEmail": {
          "type": "string",
          "desc": "验证后的邮箱地址",
          "value": "$.ValidateInput.outputs.ValidatedEmail"
        },
        "ValidatedAddress": {
          "type": "string",
          "desc": "验证后的地址信息",
          "value": "$.ValidateInput.outputs.ValidatedAddress"
        }
      },
      "outputs": {
        "CreateResult": {
          "type": "object",
          "desc": "创建操作的结果",
          "builtinAttrName": "data",
          "isDynamic": true,
          "isBuiltin": true,
          "editable": true,
          "removable": false
        }
      },
      "configs": {
        "table": "Supplier",
        "sql": "INSERT INTO \"Supplier\" (\"id\", \"code\", \"name\", \"contactName\", \"phone\", \"email\", \"address\", \"status\", \"createdAt\", \"updatedAt\") VALUES ('${GeneratedSupplierId}', '${ValidatedSupplierCode}', '${ValidatedSupplierName}', '${ValidatedContactName}', '${ValidatedPhone}', '${ValidatedEmail}', '${ValidatedAddress}', 'active', NOW(), NOW()) RETURNING \"id\""
      },
      "nextNodes": [
        "ParseCreateResult"
      ]
    },
    {
      "id": "4226a2aaab322e276c5f04b5106d3031",
      "name": "ParseCreateResult",
      "type": "code",
      "desc": "解析数据库创建操作的结果",
      "inputs": {
        "CreateResult": {
          "type": "object",
          "desc": "创建操作的结果",
          "value": "$.CreateSupplierRecord.outputs.CreateResult"
        }
      },
      "outputs": {
        "IsCreateSuccess": {
          "type": "boolean",
          "desc": "创建是否成功的标志",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        },
        "CreatedSupplierId": {
          "type": "string",
          "desc": "创建的供应商ID",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        }
      },
      "configs": {
        "file": {
          "name": "parseCreateResult.js"
        },
        "dependencies": []
      },
      "nextNodes": [
        "CheckCreateSuccess"
      ]
    },
    {
      "id": "8e40d897f723c42e675c0ac3a937f6f1",
      "name": "CheckCreateSuccess",
      "type": "condition",
      "desc": "检查供应商创建是否成功",
      "inputs": {
        "IsCreateSuccess": {
          "type": "boolean",
          "desc": "创建是否成功的标志",
          "value": "$.ParseCreateResult.outputs.IsCreateSuccess"
        }
      },
      "configs": {
        "conditionGroups": [
          {
            "conditions": [
              {
                "left": "${IsCreateSuccess}",
                "operator": "isTrue",
                "right": true
              }
            ],
            "relationship": "AND",
            "handleId": "f6f8ebe7555941ddbe936ebde36ad0e9",
            "nextNode": "HandleCreateSuccess"
          },
          {
            "conditions": [
              {
                "left": "${IsCreateSuccess}",
                "operator": "isFalse",
                "right": true
              }
            ],
            "relationship": "AND",
            "handleId": "4bb6bb60e0c945c4998288b3733c7471",
            "isDefaultBranch": true,
            "nextNode": "HandleCreateFailure"
          }
        ],
        "defaultNextNode": "HandleCreateFailure"
      }
    },
    {
      "id": "335291d9829cc9304d43dd0625909e53",
      "name": "HandleCreateSuccess",
      "type": "code",
      "desc": "处理创建成功的逻辑",
      "inputs": {
        "CreatedSupplierId": {
          "type": "string",
          "desc": "创建的供应商ID",
          "value": "$.ParseCreateResult.outputs.CreatedSupplierId"
        },
        "ValidatedSupplierName": {
          "type": "string",
          "desc": "验证后的供应商名称",
          "value": "$.ValidateInput.outputs.ValidatedSupplierName"
        }
      },
      "outputs": {
        "SuccessMessage": {
          "type": "string",
          "desc": "成功消息",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        },
        "SuccessSupplierId": {
          "type": "string",
          "desc": "成功的供应商ID",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        }
      },
      "configs": {
        "file": {
          "name": "handleCreateSuccess.js"
        },
        "dependencies": []
      },
      "nextNodes": [
        "EndSuccess"
      ]
    },
    {
      "id": "419655ed08185338a013d78a35ff43bf",
      "name": "EndSuccess",
      "type": "end",
      "desc": "成功结束节点",
      "inputs": {
        "SuccessMessage": {
          "type": "string",
          "desc": "成功消息",
          "value": "$.HandleCreateSuccess.outputs.SuccessMessage"
        },
        "SuccessSupplierId": {
          "type": "string",
          "desc": "成功的供应商ID",
          "value": "$.HandleCreateSuccess.outputs.SuccessSupplierId"
        }
      },
      "outputs": {
        "code": {
          "type": "number",
          "desc": "响应状态码",
          "value": 200,
          "builtinAttrName": "code",
          "isDynamic": true,
          "isBuiltin": true,
          "editable": true,
          "removable": false
        },
        "data": {
          "type": "object",
          "desc": "响应数据",
          "value": {
            "message": "$.HandleCreateSuccess.outputs.SuccessMessage",
            "supplierId": "$.HandleCreateSuccess.outputs.SuccessSupplierId"
          },
          "builtinAttrName": "data",
          "isDynamic": true,
          "isBuiltin": true,
          "editable": true,
          "removable": false
        },
        "message": {
          "type": "string",
          "desc": "响应消息",
          "value": "供应商创建成功",
          "builtinAttrName": "message",
          "isDynamic": true,
          "isBuiltin": true,
          "editable": true,
          "removable": false
        }
      }
    }
  ]
}