{
  "version": "1.0.0",
  "nodes": [
    {
      "id": "4268a5807352713cefce81ae7756ada2",
      "name": "Start",
      "type": "start",
      "desc": "工作流开始节点，接收用户创建参数",
      "inputs": {
        "name": {
          "type": "string",
          "desc": "用户名称",
          "value": ""
        },
        "password": {
          "type": "string",
          "desc": "用户密码",
          "value": ""
        }
      },
      "nextNodes": [
        "CheckUserExists"
      ]
    },
    {
      "id": "92f2facfd1b2ae683ae12855617b1e7b",
      "name": "CheckUserExists",
      "type": "customSQL",
      "desc": "检查用户是否已存在",
      "inputs": {
        "name": {
          "type": "string",
          "desc": "用户名称",
          "value": "$.Start.inputs.name"
        }
      },
      "outputs": {
        "data": {
          "type": "array",
          "desc": "查询结果数据",
          "builtinAttrName": "data",
          "isDynamic": true,
          "isBuiltin": true,
          "editable": true,
          "removable": false
        }
      },
      "configs": {
        "table": "user",
        "sql": "SELECT \"id\", \"name\" FROM \"user\" WHERE \"name\" = '${name}'"
      },
      "nextNodes": [
        "ParseCheckResult"
      ]
    },
    {
      "id": "e3997363ce2369e2bebd10bb48eccd1b",
      "name": "ParseCheckResult",
      "type": "code",
      "desc": "解析用户存在性检查结果",
      "inputs": {
        "checkResult": {
          "type": "array",
          "desc": "用户存在性检查结果",
          "value": "$.CheckUserExists.outputs.data"
        }
      },
      "outputs": {
        "userExists": {
          "type": "boolean",
          "desc": "用户是否存在",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        },
        "originalPassword": {
          "type": "string",
          "desc": "原始密码",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        }
      },
      "configs": {
        "file": {
          "name": "parseCheckResult.js"
        },
        "dependencies": []
      },
      "nextNodes": [
        "EncryptPassword"
      ]
    },
    {
      "id": "b57286aaf3fb95000a4c9dab782deef2",
      "name": "EncryptPassword",
      "type": "code",
      "desc": "对密码进行MD5加密处理",
      "inputs": {
        "originalPassword": {
          "type": "string",
          "desc": "原始密码",
          "value": "$.ParseCheckResult.outputs.originalPassword"
        }
      },
      "outputs": {
        "encryptedPassword": {
          "type": "string",
          "desc": "加密后的密码",
          "isDynamic": false,
          "isBuiltin": false,
          "editable": true,
          "removable": true
        }
      },
      "configs": {
        "file": {
          "name": "encryptPassword.js"
        },
        "dependencies": [
          "crypto"
        ]
      },
      "nextNodes": [
        "CreateUser"
      ]
    },
    {
      "id": "84d142753b16b59e5e3279648f688cde",
      "name": "CreateUser",
      "type": "customSQL",
      "desc": "创建新用户",
      "inputs": {
        "name": {
          "type": "string",
          "desc": "用户名称",
          "value": "$.Start.inputs.name"
        },
        "encryptedPassword": {
          "type": "string",
          "desc": "加密后的密码",
          "value": "$.EncryptPassword.outputs.encryptedPassword"
        }
      },
      "outputs": {
        "data": {
          "type": "object",
          "desc": "创建的用户数据",
          "builtinAttrName": "data",
          "isDynamic": true,
          "isBuiltin": true,
          "editable": true,
          "removable": false
        }
      },
      "configs": {
        "table": "user",
        "sql": "INSERT INTO \"user\" (\"id\", \"name\", \"password\", \"created_at\") VALUES (gen_random_uuid(), '${name}', '${encryptedPassword}', NOW()) RETURNING \"id\", \"name\", \"created_at\""
      },
      "nextNodes": [
        "End"
      ]
    },
    {
      "id": "b7a7cbb8bbf7f5adc96934bd82f37bd4",
      "name": "End",
      "type": "end",
      "desc": "工作流结束节点",
      "inputs": {
        "data": {
          "type": "object",
          "desc": "创建的用户数据",
          "value": "$.CreateUser.outputs.data"
        }
      },
      "outputs": {
        "code": {
          "type": "number",
          "desc": "响应状态码",
          "value": 200,
          "builtinAttrName": "code",
          "isDynamic": true,
          "isBuiltin": true,
          "editable": true,
          "removable": false
        },
        "message": {
          "type": "string",
          "desc": "响应消息",
          "value": "用户创建成功",
          "builtinAttrName": "message",
          "isDynamic": true,
          "isBuiltin": true,
          "editable": true,
          "removable": false
        },
        "data": {
          "type": "object",
          "desc": "响应数据",
          "builtinAttrName": "data",
          "isDynamic": true,
          "isBuiltin": true,
          "editable": true,
          "removable": false
        }
      }
    }
  ]
}